{% extends "base.html" %}

{% block title %}Форум
    <br />Раздел <a href="{% url 'forum:section' section.id %}">{{ section.name }}</a>
    <br />Тема {{ topic.name }}
{% endblock %}

{% block content %}

{% for message in messages %}
    <li>{{ message.text }}<br/>Написал {{ message.user }}: {{ message.date }}</li>
    <br />
{% endfor %}

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

{% if request.user.is_authenticated %}
    <form action="" method="post">
        {% csrf_token %}
        {{ message_form.as_p }}
        <input type="submit" value="Отправить"/>
    </form>
{% else %}
    <p>Незарегистрированные пользователи не могу писать сообщения. <a
            href="{% url 'auth_login' %}?next={{ request.get_full_path }}">Войти</a></p>
    {# TODO ссылка логин с параметром next_page на текущую, чтобы после входа возвращаться сюда и сразу писать сообщ#}
{% endif %}

{% endblock %}
